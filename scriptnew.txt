# Ultra Simple Nintex Export - No Parameters to Avoid Syntax Issues
Write-Host "Ultra Simple Nintex Export" -ForegroundColor Green

# Fixed settings - edit these directly in the script
$webUrl = "https://sp.safalo.com/hr"
$listName = "OnboardingList"
$outputPath = "C:\Exports\NintexForms"
$startID = 1
$endID = 10

Write-Host "Web: $webUrl"
Write-Host "List: $listName"
Write-Host "Output: $outputPath"
Write-Host "IDs: $startID to $endID"

# Create output folder
if (!(Test-Path $outputPath)) {
    New-Item -ItemType Directory -Path $outputPath -Force
}

# Find Chrome
$chrome = "C:\Program Files\Google\Chrome\Application\chrome.exe"
if (!(Test-Path $chrome)) {
    $chrome = "C:\Program Files (x86)\Google\Chrome\Application\chrome.exe"
}

if (!(Test-Path $chrome)) {
    Write-Host "Chrome not found" -ForegroundColor Red
    exit
}

Write-Host "Chrome: $chrome"
Write-Host ""
Write-Host "Make sure you're logged into SharePoint in Chrome first!" -ForegroundColor Yellow
Write-Host ""

$success = 0

for ($id = $startID; $id -le $endID; $id++) {
    $url = "$webUrl/Lists/$listName/DispForm.aspx?ID=$id"
    $pdfFile = "$outputPath\Form_ID$id.pdf"
    
    Write-Host "Processing ID $id"
    Write-Host "  $url"
    
    # Simple Chrome command
    $arguments = "--headless --disable-gpu --no-sandbox --print-to-pdf=`"$pdfFile`" `"$url`""
    
    Start-Process -FilePath $chrome -ArgumentList $arguments -Wait -NoNewWindow
    
    Start-Sleep -Seconds 2
    
    if (Test-Path $pdfFile) {
        $size = (Get-Item $pdfFile).Length
        if ($size -gt 1000) {
            Write-Host "  SUCCESS ($size bytes)" -ForegroundColor Green
            $success++
        } else {
            Write-Host "  FAILED (too small)" -ForegroundColor Red
        }
    } else {
        Write-Host "  FAILED (no file)" -ForegroundColor Red
    }
}

Write-Host ""
Write-Host "Completed: $success successful exports" -ForegroundColor Green
Write-Host "Files in: $outputPath"
